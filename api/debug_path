# in api/app.py
from pathlib import Path
from flask import jsonify

@app.get("/api/debug_paths")
def debug_paths():
    try:
        project_root = Path(__file__).resolve().parents[2]
        static_root = (project_root / "static").resolve()
        reports_base = (static_root / "reports").resolve()
        reports_base.mkdir(parents=True, exist_ok=True)
        testf = reports_base / "debug_write_test.txt"
        testf.write_text("ok", encoding="utf-8")
        return jsonify({
            "project_root": str(project_root),
            "static_root": str(static_root),
            "reports_base": str(reports_base),
            "test_write": str(testf),
            "ok": True
        })
    except Exception as e:
        import traceback
        return jsonify({"ok": False, "error": str(e), "traceback": traceback.format_exc()}), 500
